import {fetchFromTMDB} from './utils.js';
import {toggleItem,isInList,favKey,watchLaterKey} from './favorites.js';
const c=document.getElementById('trending-container');
(async()=>{const d=await fetchFromTMDB('/trending/all/week');c.innerHTML=d.results.map(i=>`<div class="card" data-id="${i.id}" data-type="${i.media_type||(i.title?'movie':'tv')}"><img src="https://image.tmdb.org/t/p/w300${i.poster_path}" /><h4>${i.title||i.name}</h4><button class="fav-btn">${isInList(favKey,{id:i.id,type:i.media_type})?'💔':'❤️'}</button><button class="wl-btn">${isInList(watchLaterKey,{id:i.id,type:i.media_type})?'❌':'🕒'}</button></div>`).join('');c.querySelectorAll('.fav-btn').forEach(b=>b.onclick=e=>{e.stopPropagation();const cd=b.closest('.card');toggleItem(favKey,{id:+cd.dataset.id,type:cd.dataset.type});b.textContent=isInList(favKey,{id:+cd.dataset.id,type:cd.dataset.type})?'💔':'❤️'});c.querySelectorAll('.wl-btn').forEach(b=>b.onclick=e=>{e.stopPropagation();const cd=b.closest('.card');toggleItem(watchLaterKey,{id:+cd.dataset.id,type:cd.dataset.type});b.textContent=isInList(watchLaterKey,{id:+cd.dataset.id,type:cd.dataset.type})?'❌':'🕒'});c.querySelectorAll('.card').forEach(cd=>cd.onclick=()=>{const t=cd.dataset.type,id=cd.dataset.id;location.href=`html/${t==='movie'?'movieDetail':'tvShowsDetails'}.html?id=${id}`;});})();
